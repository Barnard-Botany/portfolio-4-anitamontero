rm(list = ls())

library(picante)

JC_BRF_tree_newick = "(((((((((((((((((((((((((((Juncus:32.5578,Luzula:32.5578)Juncaceae:
16.121726,(Carex:36.2818,Cyperus:36.2818,Dulichium:36.2818,Eleocharis:36.2818,Scirpus:
36.2818)Cyperaceae:12.397796):8.029155):9.161151):11.650487):6.700159,((((((Brachyelytrum:
47.7638,Bromus:47.7638,Calamagrostis:47.7638,Cinna:47.7638,Dactylis:47.7638,Danthonia:
47.7638,Deschampsia:47.7638,Phalaris:47.7638,Dichanthelium:47.7638,Phleum:47.7638,Digitaria:
47.7638,Phragmites:47.7638,Echinochloa:47.7638,Poa:47.7638,Schizachyrium:47.7638,Setaria:
47.7638,Sorghastrum:47.7638,Sphenopholis:47.7638,Agrostis:47.7638,Andropogon:47.7638,Elymus:
47.7638,Anthoxanthum:47.7638,Elytrigia:47.7638,Arrhenatherum:47.7638,Festuca:47.7638,Avena:
47.7638,Glyceria:47.7638,Leersia:47.7638,Lolium:47.7638,Microstegium:47.7638,Muhlenbergia:
47.7638,Oryzopsis:47.7638,Panicum:47.7638)Poaceae:1.789542):4.309137):7.809344):6.449827):
13.917930,(Eriocaulon:59.5828)Eriocaulaceae:22.456843):2.180905):1.372227):4.576783,(Tyhpa:
43.0294)Typhaceae:47.140150)Poales:33.002000,((((((Commelina:73.8789)Commelinaceae:2.146677):
2.802079,((Pontederia:60.1039)Pontederiaceae:5.536893):13.186876):22.066403)Commelinales:
7.260220):12.717400):2.299880)Commelinidae:11.693860,(((((((Allium:58.4482,Erythronium:
58.4482,Hemerocallis:58.4482,Hypoxis:58.4482,Lilium:58.4482,Medeola:58.4482,Ornithogalum:
58.4482,Polygonatum:58.4482,Streptopus:58.4482,Trillium:58.4482,Uvularia:58.4482,Veratrum:
58.4482)Liliaceae:20.642664):1.497000,(Smilax:51.3738)Smilacaceae:29.214062):25.871794):
6.208706):16.804775)Liliales:5.239854,(((((((((Maianthemum:70.6927)Asparagaceae:0.525599):
4.407640):2.666944):19.582156,(Iris:81.2879,Sisyrinchium:81.2879)Iridaceae:16.587137):16.208555):
5.559875):4.220712,(Calopogon:111.445,Corallorhiza:111.445,Cypripedium:111.445,Epipactis:
111.445,Goodyera:111.445,Malaxis:111.445,Platanthera:111.445,Spiranthes:111.445)Orchidaceae:
12.419142):1.046537)Asparagales:9.802329):0.152371):2.668590,((((Dioscorea:105.177)Dioscoreaceae:
4.871258):13.850781)Dioscoreales:7.066637):6.567990):19.828273)Petrosaviidae:0.979827,(((((Elodea:
53.4313)Hydrocharitaceae:20.640677):3.412642,((Alisma:56.6206,Sagittaria:56.6206)Alismataceae:
6.868208):13.995797):18.994097,(((((Potamogeton:39.1702)Potamogetonaceae:14.655366):10.248250):
17.469889):11.901507):3.033496):48.651690,((Arisaema:123.182,Calla:123.182,Peltandra:
123.182,Symplocarpus:123.182)Araceae:17.816460):4.132240)Alismatales:13.211700)Nartheciidae:
12.924900)Monocotyledoneae:17.016266,(((((((((((((((((Rorippa:60.7464,Sinapsis:60.7464,Thlaspi:
60.7464,Alliaria:60.7464,Arabis:60.7464,Barbarea:60.7464,Brassica:60.7464,Capsella:
60.7464,Cardamine:60.7464,Hesperis:60.7464,Lepidium:60.7464)Brassicaceae:8.502491):8.070081):
0.207618):0.169508)Brassicales:23.726257,((((Dirca:58.6919)Thymelaeaceae:16.549814):
5.757813,((((Helianthemum:36.8741,Lechea:36.8741)Cistaceae:12.293208):24.135800):6.445613):
1.250857)Malvales:19.514066,((((((Rhus:59.0955,Toxicodendron:59.0955)Anacardiaceae:0.731864):
7.809366):3.304034,((((Ailanthus:43.5661)Simaroubaceae:6.434449):3.581920):15.080100):2.278190):
2.716540):0.176780)Sapindales:26.679566):0.908691):2.789943):6.809574,((Circaea:62.524,Epilobium:
62.524,Ludwigia:62.524,Oenothera:62.524)Onagraceae:25.676508,(((Decodon:67.9761,Lythrum:
67.9761,Rotala:67.9761)Lythraceae:18.516762,(((Rhexia:59.8433)Melastomataceae:5.584107):
17.464400):3.601055):0.728903):0.978722)Myrtales:22.821319):1.370987):0.275588,(((Staphylea:
32.2151)Staphyleaceae:17.682521):56.038500)Crossosomatales:6.732290):0.582040,(((Geranium:
73.7344)Geraniaceae:0.255091):35.444820)Geraniales:3.816175)Malvidae:3.627011):
0.657279,((((((((((Morus:54.7967)Moraceae:10.685446,(Humulus:47.7425)Cannabaceae:17.739669):
5.752046,(Ulmus:47.9472)Ulmaceae:23.286989):2.998663,((Laportea:56.2287,Pilea:56.2287)Urticaceae:
7.010988):10.993236):5.290883,((Ceanothus:76.1799,Rhamnus:76.1799)Rhamnaceae:0.912440):2.431378):
9.753320,(Agrimonia:82.294,Amelanchier:82.294,Aronia:82.294,Crataegus:82.294,Fragaria:82.294,Geum:
82.294,Malus:82.294,Physocarpus:82.294,Potentilla:82.294,Prunus:82.294,Pyrus:82.294,Rosa:
82.294,Rubus:82.294,Spirea:82.294)Rosaceae:6.983035)Rosales:16.658900,((((((Comptonia:
44.1761)Myricaceae:2.816150,(Carya:38.3381,Juglans:38.3381)Juglandaceae:8.654199):
2.381200,(((Carpinus:27.2796,Corylus:27.2796,Ostrya:27.2796,Alnus:27.2796,Betula:
27.2796)Betulaceae:5.515587):7.714654):8.863630):12.931900,(Fagus:40.41,Quercus:40.41,Castanea:
40.41)Fagaceae:21.895400):19.800100)Fagales:20.969300):2.861190):1.059410,((Polygala:
60.1262)Polygalaceae:11.922602,(((Amphicarpa:69.1425,Apios:69.1425,Baptisia:69.1425,Desmodium:
69.1425,Lespedeza:69.1425,Lotus:69.1425,Lupinus:69.1425,Melilotus:69.1425,Robinia:
69.1425,Trifolium:69.1425,Vicia:69.1425)Fabaceae:0.276658):2.378927):0.250678)Fabales:34.946600):
6.263220,((((((Oxalis:56.4592)Oxalidaceae:5.118950):26.471000):21.851000)Oxalidales:
1.480900,(((((((((((Populus:78.4744,Salix:78.4744)Salicaceae:12.886100):5.539201,((Viola:
59.0495)Violaceae:29.982481):7.867736):1.245890):1.181055):0.587687):0.666935,((Acalypha:
99.388,Chamaesyce:99.388,Euphorbia:99.388)Euphorbiaceae:0.597179):0.596050):
0.532812,(((((((Hypericum:68.7467,Triadenum:68.7467)Clusiaceae:2.438272):8.112584):6.974369):
7.228497):4.793658):2.435432):0.384491):2.194713,(Linum:28.0837)Linaceae:75.225064):0.986243):
1.553033)Malpighiales:5.532980):0.109862,((Celastrus:67.7436,Euonymus:67.7436)Celastraceae:
20.370800)Celastrales:23.376500):1.767730)Fabidae:0.420986):3.855140)Rosidae:
0.138911,(((((Chrysosplenium:75.2533,Heuchera:75.2533,Micranthes:75.2533,Mitella:
75.2533,Saxifraga:75.2533)Saxifragaceae:0.901188,(Ribes:45.3879)Grossulariaceae:30.766659):
8.841860):16.204100,((Penthorum:70.2681,Sedum:70.2681)Crassulaceae:19.361712):11.570700):
6.891080,((((Hamamelis:95.2833)Hamamelidaceae:8.270135):2.191394):2.131960):0.214754)Saxifragales:
9.582100)Superrosidae:1.491856,((((((((((((((((((((((Clinopodium:32.8843,Collinsonia:
32.8843,Cunila:32.8843,Hedeoma:32.8843,Leonurus:32.8843,Lycopus:32.8843,Mentha:32.8843,Monarda:
32.8843,Nepeta:32.8843,Origanum:32.8843,Prunella:32.8843,Pycnanthemum:32.8843,Scutellaria:
32.8843)Lamiaceae:8.510314,((((((Mimulus:27.4063)Phrymaceae:0.775083):3.165289):2.865533):
3.920691,(((((Phyrma:28.391,Verbena:28.391)Verbenaceae:0.812672,(Catalpa:24.8275)Bignoniaceae:
4.376157):5.841632):0.402276):0.411261):2.273981):2.929385,((Agalinis:37.4579,Gratiola:
37.4579,Linaria:37.4579,Penstemon:37.4579,Verbascum:37.4579,Veronica:37.4579)Scrophulariaceae:
3.509661):0.094686):0.332342):0.621584):0.129732,(Aureolaria:35.494,Conopholis:35.494,Epifagus:
35.494,Melampyrum:35.494,Orobanche:35.494,Pedicularis:35.494)Orobanchaceae:6.651871):
0.182246,(Utricularia:39.9512)Lentibulariaceae:2.376944):0.432809,((Chelone:31.7079,Plantago:
31.7079,Veronicastrum:31.7079)Plantaginaceae:1.214574):9.838442):0.696615):12.782970,(((Fraxinus:
39.3526,Syringa:39.3526)Oleaceae:10.741861):2.801509):3.344530):5.153970)Lamiales:
11.432543,(((Solanum:47.0276)Solanaceae:9.212855,(Calystegia:54.147,Convolvulus:
54.147)Convolvulaceae:2.093499):9.955620)Solanales:6.630930):0.542387,((Cephalanthus:
56.8699,Galium:56.8699,Mitchella:56.8699)Rubiaceae:1.934967,(((Apocynum:37.6083,Asclepias:
37.6083)Apocynaceae:9.146931):5.273650,(Bartonia:29.6472,Gentiana:29.6472,Gentianopsis:
29.6472)Gentianaceae:22.381642):6.776080)Gentianales:14.564527):1.629560,(Echium:
55.7952,Myosotis:55.7952)Boraginaceae:19.203790):0.720309):3.417357):17.813603):
4.580345)Lamiidae:1.340875,(((((((((((((Nymphoides:60.0672)Menyanthaceae:12.363000,(((Achillea:
45.7437,Ambrosia:45.7437,Anaphalis:45.7437,Antennaria:45.7437,Arctium:45.7437,Aster:
45.7437,Heliopsis:45.7437,Bidens:45.7437,Hieracium:45.7437,Centaurea:45.7437,Krigia:
45.7437,Cichorium:45.7437,Lactuca:45.7437,Lapsana:45.7437,Leucanthemum:45.7437,Prenanthes:
45.7437,Pseudognaphalium:45.7437,Rudbeckia:45.7437,Senecio:45.7437,Cirsium:45.7437,Conyza:
45.7437,Erectites:45.7437,Erigeron:45.7437,Eupatorium:45.7437,Euthamia:45.7437,Galinsoga:
45.7437,Solidago:45.7437,Gnaphalium:45.7437,Symphyotrichum:45.7437,Helianthus:45.7437,Taraxacum:
45.7437,Helenium:45.7437,Tussilago:45.7437,Xanthium:45.7437)Asteraceae:3.346060):7.104420):
16.236000):6.015739):0.292069):4.165166):0.119934):0.640582,(Campanula:52.9672,Lobelia:
52.9672,Triodanis:52.9672)Campanulaceae:30.696422)Asterales:11.753099,(((((((Cryptotaenia:
71.4481,Daucus:71.4481,Heracleum:71.4481,Hydrocotyle:71.4481,Osmorhiza:71.4481,Sanicula:
71.4481,Sium:71.4481,Zizia:71.4481,Angelica:71.4481,Cicuta:71.4481,Conioselinum:71.4481,Conium:
71.4481)Apiaceae:1.941560):2.849080):0.340050,(Aralia:65.5005,Panax:65.5005)Araliaceae:
11.078320):4.487350):1.314090):9.328050)Apiales:3.708482):0.900124,((Diervilla:65.6031,Lonicera:
65.6031,Viburnum:65.6031)Caprifoliaceae:25.752800,(Sambucus:75.3851)Adoxaceae:
15.970800)Dipsacales:4.960966):0.056880):0.252052):0.788782):3.574670,(((Ilex:
65.833,Nemopanthus:65.833)Aquifoliaceae:3.237167):25.939700)Aquifoliales:5.979370)Campanulidae:
1.882210):4.737980,(((((Nyssa:72.9991)Nyssaceae:14.875458):4.009735):5.856179,(Cornus:
65.4186)Cornaceae:32.321855)Cornales:7.935340,(((((((Sarracenia:63.59)Sarraceniaceae:
15.732659,(((((Monotropa:62.0517,Pyrola:62.0517,Rhododendron:62.0517,Vaccinium:
62.0517,Chamaedaphne:62.0517,Epigaea:62.0517,Gaultheria:62.0517,Gaylussacia:62.0517,Kalmia:
62.0517,Lyonia:62.0517)Ericaceae:3.041763):5.305970,(Clethra:56.696)Clethraceae:13.703403):
8.264239):0.153589):0.505467):2.862854):0.582584):1.114210):1.690382,(((Lysimachia:
54.0398,Trientalis:54.0398)Primulaceae:18.488688):4.059559):8.984644):6.875140,((((Impatiens:
41.8397)Balsaminaceae:3.202422):18.257429):27.869832):1.278539)Ericales:13.227930):
1.933660)Asteridae:8.908438):0.179371,((((((Polygonum:54.0144,Rumex:54.0144)Polygonaceae:
5.087963):24.304300):2.270850,((Drosera:55.7594)Droseraceae:20.118058):9.800070):
3.783420,((((((Cerastium:50.6049,Dianthus:50.6049,Lychnis:50.6049,Paronychia:50.6049,Sagina:
50.6049,Scleranthus:50.6049,Silene:50.6049,Stellaria:50.6049)Caryophyllaceae:6.366525):
4.028800,((((((((Phytolacca:35.002)Phytolaccaceae:1.494169):6.052250):1.838080):3.013950):
9.318570):0.955299):1.985320):1.340570):16.488400):5.809780):3.749530):2.412990)Caryophyllales:
25.700064,((((((((((((Comandra:14.0126)Santalaceae:2.997868):6.250706):2.972043):1.420100):
12.254193):0.438248):4.483076):11.644875):4.507825):3.504567):0.354413)Santalales:50.320525):
1.536275)Pentapetalae:1.460940)Superasteridae:0.986915):0.020375)Gunneridae:
17.734960,((((Chelidonium:112.982,Sanguinaria:112.982)Papaveraceae:19.900100,((((Coptis:
105.446,Hepatica:105.446,Ranunculus:105.446,Thalictrum:105.446,Actaea:105.446,Anemone:
105.446,Aquilegia:105.446,Caltha:105.446,Clematis:105.446)Ranunculaceae:18.954800,(Berberis:
117.268,Caulophyllum:117.268)Berberidaceae:7.132044):3.572080,(Menispermum:
67.0594)Menispermaceae:60.913100):2.332450):2.577480):0.137456)Ranunculales:
3.072206,((((Platanus:62.667)Platanaceae:32.143722):25.889700)Proteales:13.707011):1.684648):
0.808344)Eudicotyledoneae:43.727816,((((Saururus:58.3757)Saururaceae:55.827531):
7.954669,(Aristolochia:121.048,Asarum:121.048)Aristolochiaceae:1.109591)Piperales:
24.907360,(((((((Lindera:88.1284,Sassafras:88.1284)Lauraceae:2.107910):3.627775):9.557510):
5.378800)Laurales:11.900000,((((Liriodendron:59.8035)Magnoliaceae:27.553223):4.932367):
3.205910)Magnoliales:25.205400):17.213905):9.150895)Magnoliidae:33.563066):7.654960):2.257320):
3.495264)Mesangiospermae:23.596800):16.908091):8.728959,(((Brasenia:60.3235)Cabombaceae:
52.248900,(Nuphar:106.306,Nymphaea:106.306)Nymphaeaceae:6.266790):74.152300)Nymphaeales:
56.544950)Angiospermae:108.965000,(((((((Juniperus:113.564)Cupressaceae:45.052984):
60.297995)Cupressales:11.964880)Cupressophyta:35.836530):6.805170)Coniferae:
16.479100)Acrogymnospermae:62.234200)Spermatophyta:38.467865):10.085114):4.856365):5.208675):
11.765386):17.675263);"

JC_BRF_phylo = read.tree(text=JC_BRF_tree_newick)
plot(JC_BRF_phylo, type="phylogram", show.node.label=TRUE)

setwd("/Users/anita/Desktop/project")
JC_BRF_matrix <- read.csv("JC_BRF_matrix.csv")
JC_BRF_matrix <- as.matrix(JC_BRF_matrix)
dim(JC_BRF_matrix)

plot(JC_BRF_phylo, adj = 0.05, show.tip.label = T, show.node.label=F, cex = 0.2)
tiplabels(tip = which(JC_BRF_phylo$tip.label %in% names(which(JC_BRF_matrix [1, ] > 0))),pch=19, cex=0.4)
